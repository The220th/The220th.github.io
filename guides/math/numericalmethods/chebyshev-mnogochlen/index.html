<!doctype html><html lang=ru><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="Содержание Введение Узлы Чебышёва Оценка погрешности Код   Введение Возможно всё было так: Чебышёв нашёл крутой многочлен n-ой степени: $T_n = cos(n \cdot arccos(x))$
Назвали его многочленом Чебышева. Выглядит как не многочлен, но это именно он. Немного подумав можно прийти к такому выводу:
$$\cos((n+1) \cdot \arccos(x)) = 2 \cdot \cos(\arccos(x)) \cdot \cos(n \cdot \arccos(x)) - \cos((n-1) \cdot \arccos(x))$$
$$\cos((n+1) \cdot \arccos(x)) = 2 \cdot x \cdot \cos(n \cdot \arccos(x)) - \cos((n-1) \cdot \arccos(x))$$"><meta name=keywords content><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://the220th.github.io/guides/math/numericalmethods/chebyshev-mnogochlen/><title>Многочлен Чебышева // the220th stash</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.abca74aa73d245e5c7dbbf1750d4f7276222e436c8fe5f3602df9b08596cf389.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css integrity=sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><meta itemprop=name content="Многочлен Чебышева"><meta itemprop=description content="Содержание Введение Узлы Чебышёва Оценка погрешности Код   Введение Возможно всё было так: Чебышёв нашёл крутой многочлен n-ой степени: $T_n = cos(n \cdot arccos(x))$
Назвали его многочленом Чебышева. Выглядит как не многочлен, но это именно он. Немного подумав можно прийти к такому выводу:
$$\cos((n+1) \cdot \arccos(x)) = 2 \cdot \cos(\arccos(x)) \cdot \cos(n \cdot \arccos(x)) - \cos((n-1) \cdot \arccos(x))$$
$$\cos((n+1) \cdot \arccos(x)) = 2 \cdot x \cdot \cos(n \cdot \arccos(x)) - \cos((n-1) \cdot \arccos(x))$$"><meta itemprop=datePublished content="2021-04-14T22:06:10+03:00"><meta itemprop=dateModified content="2021-04-14T22:06:10+03:00"><meta itemprop=wordCount content="737"><meta itemprop=image content="https://the220th.github.io"><meta itemprop=keywords content><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://the220th.github.io"><meta name=twitter:title content="Многочлен Чебышева"><meta name=twitter:description content="Содержание Введение Узлы Чебышёва Оценка погрешности Код   Введение Возможно всё было так: Чебышёв нашёл крутой многочлен n-ой степени: $T_n = cos(n \cdot arccos(x))$
Назвали его многочленом Чебышева. Выглядит как не многочлен, но это именно он. Немного подумав можно прийти к такому выводу:
$$\cos((n+1) \cdot \arccos(x)) = 2 \cdot \cos(\arccos(x)) \cdot \cos(n \cdot \arccos(x)) - \cos((n-1) \cdot \arccos(x))$$
$$\cos((n+1) \cdot \arccos(x)) = 2 \cdot x \cdot \cos(n \cdot \arccos(x)) - \cos((n-1) \cdot \arccos(x))$$"><meta property="og:title" content="Многочлен Чебышева"><meta property="og:description" content="Содержание Введение Узлы Чебышёва Оценка погрешности Код   Введение Возможно всё было так: Чебышёв нашёл крутой многочлен n-ой степени: $T_n = cos(n \cdot arccos(x))$
Назвали его многочленом Чебышева. Выглядит как не многочлен, но это именно он. Немного подумав можно прийти к такому выводу:
$$\cos((n+1) \cdot \arccos(x)) = 2 \cdot \cos(\arccos(x)) \cdot \cos(n \cdot \arccos(x)) - \cos((n-1) \cdot \arccos(x))$$
$$\cos((n+1) \cdot \arccos(x)) = 2 \cdot x \cdot \cos(n \cdot \arccos(x)) - \cos((n-1) \cdot \arccos(x))$$"><meta property="og:type" content="article"><meta property="og:url" content="https://the220th.github.io/guides/math/numericalmethods/chebyshev-mnogochlen/"><meta property="og:image" content="https://the220th.github.io"><meta property="article:section" content="guides"><meta property="article:published_time" content="2021-04-14T22:06:10+03:00"><meta property="article:modified_time" content="2021-04-14T22:06:10+03:00"><meta property="og:site_name" content="the220th stash"><meta property="article:published_time" content="2021-04-14 22:06:10 +0300 +0300"></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>the220th stash</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/guides>Гайды</a></li><li><a href=/resources>Ресурсы</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span><span class="search-icon not-selectable"><a href=/search><svg class="theme-toggler" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" id="Capa_1" width="100%" height="100%" viewBox="0 0 300 300" style="enable-background:new 0 0 310.42 310.42" sodipodi:docname="magnifier.svg" inkscape:version="1.0.2-2 (e86c870879, 2021-01-15)"><defs id="defs45"/><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="1844" inkscape:window-height="1057" id="namedview43" showgrid="false" inkscape:zoom="2.027334" inkscape:cx="196.11542" inkscape:cy="182.64093" inkscape:window-x="-8" inkscape:window-y="-8" inkscape:window-maximized="1" inkscape:current-layer="Capa_1"/><g id="g10" transform="matrix(-1,0,0,1,310.41981,0)"><g id="g8"><path d="m273.587 214.965c49.11-49.111 49.109-129.021.0-178.132-49.111-49.111-129.02-49.111-178.13.0C53.793 78.497 47.483 140.462 76.51 188.85c0 0 2.085 3.498-.731 6.312-16.065 16.064-64.263 64.263-64.263 64.263-12.791 12.79-15.836 30.675-4.493 42.02l1.953 1.951c11.343 11.345 29.229 8.301 42.019-4.49.0.0 48.096-48.097 64.128-64.128 2.951-2.951 6.448-.866 6.448-.866 48.387 29.026 110.352 22.717 152.016-18.947zM118.711 191.71C82.423 155.422 82.424 96.378 118.712 60.09c36.288-36.287 95.332-36.288 131.619.0 36.288 36.287 36.288 95.332.0 131.62-36.288 36.286-95.331 36.286-131.62.0z" id="path2"/><g id="g6"><path d="m126.75 118.424c-1.689.0-3.406-.332-5.061-1.031-6.611-2.798-9.704-10.426-6.906-17.038 17.586-41.559 65.703-61.062 107.261-43.476 6.611 2.798 9.704 10.426 6.906 17.038-2.799 6.612-10.425 9.703-17.039 6.906-28.354-11.998-61.186 1.309-73.183 29.663-2.099 4.959-6.913 7.938-11.978 7.938z" id="path4"/></g></g></g><g id="g12" transform="matrix(-1,0,0,1,310.41981,0)"/><g id="g14" transform="matrix(-1,0,0,1,310.41981,0)"/><g id="g16" transform="matrix(-1,0,0,1,310.41981,0)"/><g id="g18" transform="matrix(-1,0,0,1,310.41981,0)"/><g id="g20" transform="matrix(-1,0,0,1,310.41981,0)"/><g id="g22" transform="matrix(-1,0,0,1,310.41981,0)"/><g id="g24" transform="matrix(-1,0,0,1,310.41981,0)"/><g id="g26" transform="matrix(-1,0,0,1,310.41981,0)"/><g id="g28" transform="matrix(-1,0,0,1,310.41981,0)"/><g id="g30" transform="matrix(-1,0,0,1,310.41981,0)"/><g id="g32" transform="matrix(-1,0,0,1,310.41981,0)"/><g id="g34" transform="matrix(-1,0,0,1,310.41981,0)"/><g id="g36" transform="matrix(-1,0,0,1,310.41981,0)"/><g id="g38" transform="matrix(-1,0,0,1,310.41981,0)"/><g id="g40" transform="matrix(-1,0,0,1,310.41981,0)"/></svg></a></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://the220th.github.io/guides/math/numericalmethods/chebyshev-mnogochlen/>Многочлен Чебышева</a></h2><hr><div class=post-content><h2>Содержание</h2><nav id=TableOfContents><ul><li><a href=#введение>Введение</a></li><li><a href=#узлы-чебышёва>Узлы Чебышёва</a></li><li><a href=#оценка-погрешности>Оценка погрешности</a></li><li><a href=#код>Код</a></li></ul></nav><h2 id=введение>Введение</h2><p>Возможно всё было так:
Чебышёв нашёл крутой многочлен n-ой степени: $T_n = cos(n \cdot arccos(x))$</p><p>Назвали его многочленом Чебышева.
Выглядит как не многочлен, но это именно он. Немного подумав можно прийти к такому выводу:</p><p>$$\cos((n+1) \cdot \arccos(x)) = 2 \cdot \cos(\arccos(x)) \cdot \cos(n \cdot \arccos(x)) - \cos((n-1) \cdot \arccos(x))$$</p><p>$$\cos((n+1) \cdot \arccos(x)) = 2 \cdot x \cdot \cos(n \cdot \arccos(x)) - \cos((n-1) \cdot \arccos(x))$$</p><p>$$T_{n+1} = 2 \cdot x \cdot T_n - T_{n-1}$$</p><p>Всё равно не похоже на многочлен&mldr;</p><p>Воспользуемся этой формулой в явном виде:</p><p>$$T_0 = \cos(0 \cdot \arccos(x)) = 1$$</p><p>$$T_1 = \cos(1 \cdot \arccos(x)) = x$$</p><p>$$T_2 = 2 \cdot x \cdot T_1 - T_0 = 2x^2 - 1$$</p><p>$$T_3 = 2 \cdot x \cdot T_2 - T_1 = 4x^3 - 3x$$</p><p>$$T_4 = 2 \cdot x \cdot T_3 - T_2 = 8x^4 - 8x^2 + 1$$</p><p>$$T_5 = 2 \cdot x \cdot T_4 - T_3 = 16x^5 - 20x^3 + 5x$$</p><p>$$&mldr;$$</p><p>Теперь видно, что именно многочлены. Проверьте, например так:</p><p>$$T_5(3.2) = \cos(5 \cdot \arccos(3.2)) = 4729.35&mldr;$$</p><p>$$T_5(3.2) = 16 \cdot (3.2)^5 - 20 \cdot (3.2)^3 + 5 \cdot (3.2) = 4729.35&mldr;$$</p><p>Зачем всё это?
Есть очень крутая особенность у этих многочленов:</p><ol><li><p>На промежутке [-1, 1]: $\max_{[-1, 1]}(T_n) = 1$, $\min_{[-1, 1]}(T_n) = -1$</p></li><li><p>Старший коэф. перед $x^n$ равен $2^{(n-1)}$</p></li></ol><p>Давайте нормализируем многочлен:</p><p>Пусть $T^*_n = \frac{T_n}{2^{(n-1)} }$</p><p>Зачем нужен $T^*_n$? У него есть ещё более крутые особенности:</p><ol><li><p>На промежутке [-1, 1]: $\max_{[-1, 1]}(T^*_n) = \frac{1}{ 2^{(n-1)} }$, $\min_{[-1, 1]}(T^*_n) = -\frac{1}{ 2^{(n-1)} }$</p></li><li><p>Старший коэф. перед $x^n$ равен 1</p></li></ol><p>1-ая особенность особенно значимая</p><h2 id=узлы-чебышёва>Узлы Чебышёва</h2><p>Теперь нужно найти корни этого многочлена:</p><p>$$T^*_n = 0$$</p><p>$$\frac{\cos(n \cdot \arccos(x))}{2^{(n-1)}} = 0$$</p><p>$$\cos(n \cdot \arccos(x)) = 0$$</p><p>$$n \cdot \arccos(x) = \frac{\pi}{2} + \pi \cdot k$$</p><p>$$\arccos(x) = \frac{\pi}{2 \cdot n} + \frac{\pi \cdot k}{n}$$</p><p>$$x = \cos(\frac{pi}{2 \cdot n} + \frac{\pi \cdot k}{n})$$</p><p>$$x_k = \cos( \frac{ (2 \cdot k + 1) \cdot \pi }{2 \cdot n} )$$, k = 0, 1, 2, &mldr;, n-1</p><p>Замечу: Тут именно от 0 до n-1. Т. е. кол-во узлов = n шт</p><p>Т. е. $T^*_n = \frac{1}{2^{(n-1)}} \cdot (x-x_0) \cdot (x-x_1) \cdot &mldr;$</p><p>Находим на отрезке от [-1, 1] узлы $x_k$:</p><p>$$x_1 = \cos( \frac{ (2 \cdot 0 + 1) \cdot \pi }{2 \cdot n} )$$</p><p>$$x_2 = \cos( \frac{ (2 \cdot 1 + 1) \cdot \pi }{2 \cdot n} )$$</p><p>$$&mldr;$$</p><p>И этим иксам [$x_1$, $x_2$, &mldr;] соответствуют игреки [$y_1=f(x_1)$, $y_2=f(x_2)$, &mldr;]. Всё, можно интерполировать</p><p>Почему именно так? Помните оценку погрешности интерполяционных многочленов?</p><h2 id=оценка-погрешности>Оценка погрешности</h2><p>$\max_{[-1, 1]}(|f(x)-L_n(x)|) \leq \frac{M_{n+1}} {(n+1)!} \cdot \max_{[-1,1]}(|\omega_n(x)|)$, где $M_{n+1}=\max_{[-1,1]}(\frac{d^{(n+1)}f}{dx^{(n+1)}})$</p><p>То есть производная (n+1)-го порядка $f^{(n+1)}_x$</p><p>Что такое $\omega_n$? Это и есть $T^*_{n+1}$</p><p>Помните его max и min из особенности 1? $\max_{[-1,1]}(|\omega_n|) = \max_{[-1,1]}(|T^*_{n+1}|) = \frac{1}{ 2^n }$. Т. е. оооооочень маленькое число уже хотя бы при n=5</p><p>Т.е.
$$\max_{[-1, 1]}{(|f(x)-L_n(x)|)} \leq \frac{M_{n+1}}{(n+1)!} \cdot \frac{1}{2^n}$$</p><p>Но это ведь на отрезке [-1, 1]. Кому это нужно? Ну перенесём на наш отрезок [a, b] (аффинное преобразование):</p><p>$$x_k = \frac{1}{2} \cdot ((b-a) \cdot \cos( \frac{(2 \cdot k + 1) \cdot \pi}{2 \cdot n + 2} ) + b + a)$$, k = 0, 1, &mldr;, n</p><p>Вывод этой формулы - это путь ниндзя, и поэтому каждый его должен пройти сам, если, конечно, есть желание&mldr;</p><p>$$T^*_n = \frac{1}{2^{n-1}} \cdot (x-x_0) \cdot (x-x_1) \cdot &mldr;$$</p><p>А что там с погрешностью? Это тоже путь ниндзя, но вот формула:</p><p>$$\max_{[a,b]}(|w_n(x)|) = \frac{(b-a)^{(n+1)}}{2^{(2 \cdot n+1)}}$$</p><p>Т.е. погрешность:</p><p>$$\max_{[a, b]}(|f(x)-L_n(x)|) \leq \frac{M_{n+1}}{(n+1)!} \cdot \frac{(b-a)^{(n+1)}}{2^{(2 \cdot n+1)}}$$</p><p>где $$M_{n+1}=\max_{[a,b]}(\frac{d^{(n+1)}f}{dx^{(n+1)}})$$</p><p>Главное помнить, что n - это степень многочлена, а не количество узлов</p><h2 id=код>Код</h2><p>Что мы хотим вообще? Хотим функцию <code>findChebyshevNodes()</code>, которая бы просто вернула &ldquo;массив&rdquo; правильных &ldquo;иксов&rdquo;. Код будет на matlab, как бы сильно не хотелось обратного:</p><div class=highlight><pre class=chroma><code class=language-matlab data-lang=matlab><span class=c>% a - левая граница</span>
<span class=c>% b - правая граница</span>
<span class=c>% n - кол-во &#34;иксов&#34; (узлов)</span>
<span class=k>function</span><span class=w> </span>res <span class=p>=</span><span class=w> </span><span class=nf>findChebyshevNodes</span><span class=p>(</span>a, b, n<span class=p>)</span><span class=w>
</span><span class=w></span><span class=n>n</span> <span class=p>=</span> <span class=n>n</span><span class=o>-</span><span class=mi>1</span><span class=p>;</span> <span class=c>% потому что в формуле используется степень многочлена, которая на 1 меньше кол-ва узлов</span>
<span class=n>res</span> <span class=p>=</span> <span class=nb>zeros</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>n</span><span class=o>+</span><span class=mi>1</span><span class=p>);</span>
<span class=k>for</span> <span class=nb>i</span> <span class=p>=</span> <span class=mi>1</span><span class=p>:(</span><span class=n>n</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span>
    <span class=n>res</span><span class=p>(</span><span class=nb>i</span><span class=p>)</span> <span class=p>=</span> <span class=p>(</span><span class=mi>1</span><span class=o>/</span><span class=mi>2</span><span class=p>)</span><span class=o>*</span><span class=p>((</span><span class=n>b</span><span class=o>-</span><span class=n>a</span><span class=p>)</span><span class=o>*</span><span class=nb>cos</span><span class=p>(</span> <span class=p>((</span><span class=mi>2</span><span class=o>*</span><span class=p>(</span><span class=nb>i</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=nb>pi</span><span class=p>)</span><span class=o>/</span><span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=n>n</span><span class=o>+</span><span class=mi>2</span><span class=p>)</span> <span class=p>)</span> <span class=o>+</span> <span class=n>b</span> <span class=o>+</span> <span class=n>a</span><span class=p>);</span>
<span class=k>end</span>
</code></pre></div><p>и заодно высчитать максимальную погрешность:</p><div class=highlight><pre class=chroma><code class=language-matlab data-lang=matlab><span class=c>%max[a, b](|f(x)-L_n(x)|) &lt;= (M_{n+1} / (n+1)!)*( (b-a)^(n+1) / (2^(2*n+1)) ), где M_{n+1}=max[a,b](d^(n+1)f/dx^(n+1))</span>
<span class=c>%Здесь n - это степень многочлена, а не кол-во точек (их на 1 больше)</span>

<span class=k>function</span><span class=w> </span>res <span class=p>=</span><span class=w> </span><span class=nf>findChebyshevDefect</span><span class=p>(</span>n_dots<span class=p>)</span><span class=w>
</span><span class=w></span><span class=n>n</span> <span class=p>=</span> <span class=n>n_dots</span><span class=p>;</span>
<span class=n>a</span> <span class=p>=</span> <span class=mi>1</span><span class=p>;</span>
<span class=n>b</span> <span class=p>=</span> <span class=mi>71</span><span class=p>;</span>
<span class=n>res</span> <span class=p>=</span> <span class=p>((</span>здесь <span class=n>M_</span><span class=p>{</span><span class=n>n</span><span class=o>+</span><span class=mi>1</span><span class=p>})</span> <span class=o>/</span> <span class=nb>factorial</span><span class=p>(</span><span class=n>n</span><span class=p>))</span><span class=o>*</span><span class=p>(</span> <span class=p>(</span><span class=n>b</span><span class=o>-</span><span class=n>a</span><span class=p>)</span>^<span class=n>n</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span>^<span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=n>n</span><span class=o>-</span><span class=mi>1</span><span class=p>))</span> <span class=p>);</span>
</code></pre></div><p>Дальше, зная &ldquo;иксы&rdquo;=X, найдём &ldquo;игреки&rdquo;=Y и подставим в какую-нибудь фукцию, которая делает интерполяцию.</p></div></article><hr><div class=post-info></p><p> 14 Апреля, 2021 г.</p></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2021</span>
<span><a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a></span></div></div><div class=footer__inner><div class=footer__content><span><a href=https://github.com/rhazdon/hugo-theme-hello-friend-ng>Hello Friend NG</a></span><span><a href=http://gohugo.io>Hugo</a></span></div></div></footer></div><script defer language=javascript type=text/javascript src=/js/main.js></script><script defer language=javascript type=text/javascript src=/js/menu.js></script><script src=https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js></script><script>addBackToTop({diameter:56,backgroundColor:'#2e2c2b',textColor:'#ffc400'})</script></body></html>